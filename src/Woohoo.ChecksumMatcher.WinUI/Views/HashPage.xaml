<Page
    x:Class="Woohoo.ChecksumMatcher.WinUI.Views.HashPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:converters="using:CommunityToolkit.WinUI.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:vm="using:Woohoo.ChecksumMatcher.WinUI.ViewModels"
    mc:Ignorable="d">

    <Page.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </Page.Resources>

    <ScrollViewer Margin="0,0,-50,0">
        <StackPanel Margin="0,0,50,20">
            <CommandBar
                HorizontalAlignment="Left"
                DefaultLabelPosition="Right"
                IsOpen="True">
                <AppBarButton
                    Command="{x:Bind ViewModel.SelectFileCommand, Mode=OneWay}"
                    Icon="Add"
                    Label="Select File..." />
                <AppBarButton
                    Command="{x:Bind ViewModel.CollapseAllCommand, Mode=OneWay}"
                    Icon="Trim"
                    Label="Collapse All" />
                <AppBarButton
                    Command="{x:Bind ViewModel.ClearCommand, Mode=OneWay}"
                    Icon="Clear"
                    Label="Clear" />
            </CommandBar>
            <ItemsRepeater ItemsSource="{x:Bind ViewModel.Results}">
                <ItemsRepeater.ItemTemplate>
                    <DataTemplate x:DataType="vm:HashFileResultViewModel">
                        <controls:SettingsExpander
                            Margin="0,0,0,4"
                            Description="{x:Bind FullPath, Mode=OneWay}"
                            Header="File hash"
                            HeaderIcon="{ui:FontIcon Glyph=&#xE946;}"
                            IsExpanded="{x:Bind IsExpanded, Mode=TwoWay}">
                            <Button Command="{x:Bind CopyHashCommand, Mode=OneWay}" Content="Copy" />
                            <controls:SettingsExpander.Items>
                                <controls:SettingsCard ContentAlignment="Left">
                                    <StackPanel>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" MinWidth="50" />
                                                <ColumnDefinition Width="12" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <TextBlock
                                                Grid.Row="0"
                                                Grid.Column="0"
                                                Margin="{StaticResource SmallTopMargin}"
                                                VerticalAlignment="Center"
                                                Text="Name" />
                                            <TextBox
                                                Grid.Row="0"
                                                Grid.Column="2"
                                                Margin="{StaticResource SmallTopMargin}"
                                                VerticalAlignment="Center"
                                                IsReadOnly="True"
                                                Text="{x:Bind Name, Mode=OneWay}" />
                                            <TextBlock
                                                Grid.Row="1"
                                                Grid.Column="0"
                                                Margin="{StaticResource SmallTopMargin}"
                                                VerticalAlignment="Center"
                                                Text="Size" />
                                            <TextBox
                                                Grid.Row="1"
                                                Grid.Column="2"
                                                Margin="{StaticResource SmallTopMargin}"
                                                VerticalAlignment="Center"
                                                IsReadOnly="True"
                                                Text="{x:Bind FileSize, Mode=OneWay}" />
                                        </Grid>
                                        <ItemsRepeater ItemsSource="{x:Bind Hashes}">
                                            <ItemsRepeater.ItemTemplate>
                                                <DataTemplate x:DataType="vm:HashChecksumResultViewModel">
                                                    <Grid Margin="{StaticResource SmallTopMargin}">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" MinWidth="50" />
                                                            <ColumnDefinition Width="12" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock
                                                            Grid.Column="0"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind Algorithm}" />
                                                        <TextBox
                                                            Grid.Column="2"
                                                            VerticalAlignment="Center"
                                                            IsReadOnly="True"
                                                            Text="{x:Bind Value, Mode=OneWay}" />
                                                    </Grid>
                                                </DataTemplate>
                                            </ItemsRepeater.ItemTemplate>
                                        </ItemsRepeater>
                                        <ProgressBar
                                            Margin="{StaticResource MediumTopMargin}"
                                            IsIndeterminate="False"
                                            Visibility="{x:Bind IsCalculating, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                                            Value="{x:Bind FileProgress, Mode=OneWay}" />
                                    </StackPanel>
                                </controls:SettingsCard>
                            </controls:SettingsExpander.Items>
                        </controls:SettingsExpander>
                    </DataTemplate>
                </ItemsRepeater.ItemTemplate>
            </ItemsRepeater>
        </StackPanel>
    </ScrollViewer>
</Page>
